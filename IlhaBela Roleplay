-- Ilha Bela RP Bot - 2026 Ronix Compatible

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Workspace = game:GetService("Workspace")

local player = Players.LocalPlayer
local camera = Workspace.CurrentCamera

-- Toggles
local bot = false
local aimbot = false
local esp = false

-- ESP storage
local espCache = {}

-- Utils
local function getChar(p)
    return p.Character
end

local function getRoot(char)
    return char and char:FindFirstChild("HumanoidRootPart")
end

-- ================= ESP (HIGHLIGHT) =================
local function createESP(char)
    if espCache[char] then return end
    local hl = Instance.new("Highlight")
    hl.FillColor = Color3.fromRGB(255, 0, 0)
    hl.OutlineColor = Color3.fromRGB(255, 255, 255)
    hl.FillTransparency = 0.5
    hl.Adornee = char
    hl.Parent = char
    espCache[char] = hl
end

local function clearESP()
    for _, v in pairs(espCache) do
        if v then v:Destroy() end
    end
    espCache = {}
end

-- ================= TARGET =================
local function getTarget()
    local mousePos = UserInputService:GetMouseLocation()
    local ray = camera:ViewportPointToRay(mousePos.X, mousePos.Y)

    local params = RaycastParams.new()
    params.FilterDescendantsInstances = {player.Character}
    params.FilterType = Enum.RaycastFilterType.Blacklist

    local result = Workspace:Raycast(ray.Origin, ray.Direction * 1000, params)
    if result and result.Instance then
        local model = result.Instance:FindFirstAncestorOfClass("Model")
        if model and model:FindFirstChild("Humanoid") then
            return model
        end
    end
end

-- ================= LOOP =================
RunService.RenderStepped:Connect(function()
    if not bot then return end

    local target = getTarget()
    if not target then return end

    local root = getRoot(target)
    if not root then return end

    -- AIMBOT
    if aimbot then
        camera.CFrame = CFrame.new(
            camera.CFrame.Position,
            root.Position
        )
    end
end)

-- ================= ESP UPDATE =================
RunService.RenderStepped:Connect(function()
    if not esp then return end
    for _, p in ipairs(Players:GetPlayers()) do
        if p ~= player then
            local char = getChar(p)
            if char then
                createESP(char)
            end
        end
    end
end)

-- ================= GUI =================
local gui = Instance.new("ScreenGui", player.PlayerGui)

local frame = Instance.new("Frame", gui)
frame.Size = UDim2.new(0, 220, 0, 180)
frame.Position = UDim2.new(0.05, 0, 0.3, 0)
frame.BackgroundColor3 = Color3.fromRGB(25,25,25)

local function button(text, y, func)
    local b = Instance.new("TextButton", frame)
    b.Size = UDim2.new(1, 0, 0, 40)
    b.Position = UDim2.new(0, 0, y, 0)
    b.Text = text
    b.TextColor3 = Color3.new(1,1,1)
    b.BackgroundColor3 = Color3.fromRGB(40,40,40)
    b.MouseButton1Click:Connect(func)
end

button("Ativar Bot", 0, function()
    bot = not bot
    if not bot then
        aimbot = false
        esp = false
        clearESP()
    end
end)

button("Aimbot", 40, function()
    aimbot = not aimbot
end)

button("ESP", 80, function()
    esp = not esp
    if not esp then clearESP() end
end)

button("Fechar", 120, function()
    gui:Destroy()
    clearESP()
end)
